{
    "timestamp": "%{strftime(\{"%Y-%m-%dT%H:%M:%S"\}, time.start) "." time.start.usec_frac}V",
    "severity": "%{if(resp.status >= 500, "ERROR", if(resp.status >= 400, "WARN", "INFO"))}V",
    "httpRequest": {
      "requestMethod": "%{json.escape(req.method)}V",
      "requestUrl": "%{if(req.is_ssl, "https", "http") "://" if(req.http.Fastly-Orig-Host, req.http.Fastly-Orig-Host, req.http.Host) req.url}V",
      "requestSize": %{req.bytes_read}V,
      "status": %{resp.status}V,
      "responseSize": %{resp.bytes_written}V,
      "userAgent": "%{json.escape(req.http.User-Agent)}V",
      "remoteIp": "%{req.http.Fastly-Client-IP}V",
      "referer": "%{json.escape(req.http.referer)}V",
      "latency": %{time.elapsed.sec "." time.elapsed.usec_frac}V,
      "cacheHit": %{if(fastly_info.state ~ "HIT(?:-|\z)", "true", "false")}V,
      "protocol": "%{json.escape(req.proto)}V"
    },
    "trace": "%{json.escape(req.http.x-trace-id)}V",
    "spanId": "%{json.escape(req.http.x-trace-vcl-span-id)}V"
  }
  